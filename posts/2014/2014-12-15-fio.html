<!DOCTYPE html>
<html lang="en">
<head>
          <title>> /dev/null > 2>&1</title>
        <meta charset="utf-8" />
        <link href="http://blog.heimsbakk.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="> /dev/null > 2>&1 Full Atom Feed" />
        <link href="http://blog.heimsbakk.net/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="> /dev/null > 2>&1 Categories Atom Feed" />



    <meta name="tags" contents="io" />
    <meta name="tags" contents="benchmark" />
    <meta name="tags" contents="howto" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://blog.heimsbakk.net/">> /dev/null > 2>&1 <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/index.html">home</a></li>
            <li><a href="#">|</a></li>
              <li class="active"><a href="http://blog.heimsbakk.net/category/blog.html">blog</a></li>
              <li><a href="http://blog.heimsbakk.net/category/uris.html">uris</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="http://blog.heimsbakk.net/posts/2014/2014-12-15-fio.html" rel="bookmark"
         title="Permalink to fio - flexible I/O tester">fio - flexible I/O tester</a></h2>
 
  </header>
  <footer class="post-info">
    <abbr class="published" title="2014-12-15T00:00:00">
      ma. 15 desember 2014
    </abbr>
    <address class="vcard author">
      By           <a class="url fn" href="http://blog.heimsbakk.net/author/arnulf.html">arnulf</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>From man page: <code>fio</code> <em>is a tool that will spawn a number of threads or processes doing a particular type of I/O action as specified by the user. The typical use of fio is to write a job file matching the I/O load one wants to simulate.</em></p>
<p>This example only show how to use <code>fio</code> to make reproduceable test on a file system. For me it's been useful to catch changes in I/O throughput before and after a system has gone into production. Buy running the same tests on all systems the numbers are comparable. </p>
<p>All parameter numbers are examples, define your own test according to what you want to measure. </p>
<h2>Installing fio</h2>
<div class="highlight"><pre><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">fio</span>
</pre></div>


<h2>Running fio</h2>
<ul>
<li>Change <code>bsrange</code> to the block size range you want to test. </li>
<li><code>numjobs</code> is the number of simultanious read/write threads.</li>
<li><code>size</code> is the working file size.</li>
<li>If you want to test a read heavy load, use <code>rwmixread</code> with a percentage of reads versus writes..</li>
</ul>
<div class="highlight"><pre><span class="k">for </span>i in <span class="nb">read </span>write readwrite randread randwrite randrw; <span class="k">do </span>fio --name<span class="o">=</span>fio  --write_bw_log<span class="o">=</span><span class="nv">$i</span> --write_iops_log<span class="o">=</span><span class="nv">$i</span> --write_lat_log<span class="o">=</span><span class="nv">$i</span> --ioengine<span class="o">=</span>sync --size<span class="o">=</span>10G --runtime<span class="o">=</span>60 --rw<span class="o">=</span><span class="nv">$i</span> --norandommap --refill_buffers --randrepeat<span class="o">=</span>0  --iodepth<span class="o">=</span>1 --direct<span class="o">=</span>1 --numjobs<span class="o">=</span>8 --group_reporting --bsrange<span class="o">=</span>4k-4k; <span class="k">done</span>
</pre></div>


<h2>Generating I/O plots</h2>
<div class="highlight"><pre>fio2gnuplot -i -g
</pre></div>


<p>For me is the most interesting plot is <strong>compare-result-2Dsmooth.png</strong>.</p>
<h2>Generating bandwidth plots</h2>
<p>Testing bandwidth is better to do with a larger block size. I usually set a block size between 64k to 1m. </p>
<div class="highlight"><pre><span class="k">for </span>i in <span class="nb">read </span>write readwrite randread randwrite randrw; <span class="k">do </span>fio --name<span class="o">=</span>fio  --write_bw_log<span class="o">=</span><span class="nv">$i</span> --write_iops_log<span class="o">=</span><span class="nv">$i</span> --write_lat_log<span class="o">=</span><span class="nv">$i</span> --ioengine<span class="o">=</span>sync --size<span class="o">=</span>10G --runtime<span class="o">=</span>60 --rw<span class="o">=</span><span class="nv">$i</span> --norandommap --refill_buffers --randrepeat<span class="o">=</span>0  --iodepth<span class="o">=</span>1 --direct<span class="o">=</span>1 --numjobs<span class="o">=</span>8 --group_reporting --bsrange<span class="o">=</span>64k-1m; <span class="k">done</span>
</pre></div>


<p>Generate the bandwidth plot.</p>
<div class="highlight"><pre>fio2gnuplot -b -g
</pre></div>


<p>For me is the most interesting plot is <strong>compare-result-2Dsmooth.png</strong>.</p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>